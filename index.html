<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="theme-color" content="#6750A4" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#D0BCFF" media="(prefers-color-scheme: dark)">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="時間表">
    <meta name="description" content="學校實時時間表應用程式 - 查看課程時間、倒計時、通知提醒">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-32.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;600;700&family=Roboto+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    
    <title>實時時間表</title>
</head>
<body>
    <!-- Offline Indicator -->
    <div class="offline-indicator" id="offline-indicator">
        <span class="material-symbols-rounded">cloud_off</span>
        <span>離線模式</span>
    </div>

    <!-- Pull to Refresh -->
    <div class="pull-to-refresh" id="pull-to-refresh">
        <span class="material-symbols-rounded">refresh</span>
        <span>更新中...</span>
    </div>

    <!-- Main App Container -->
    <div class="app-container">
        <!-- Notification Permission Banner -->
        <div class="notification-banner" id="notification-banner">
            <span class="material-symbols-rounded">notifications</span>
            <div class="notification-banner__content">
                <div class="notification-banner__title">開啟課堂提醒</div>
                <div class="notification-banner__text">在課堂開始前收到通知</div>
            </div>
            <div class="notification-banner__actions">
                <button class="btn btn--text" id="dismiss-notification-banner">稍後</button>
                <button class="btn btn--filled" id="enable-notifications">開啟</button>
            </div>
        </div>

        <!-- Top App Bar -->
        <header class="top-app-bar">
            <h1 class="top-app-bar__title">實時時間表</h1>
            
            <div class="top-app-bar__actions">
                <!-- View Switcher (Desktop) -->
                <div class="segmented-button">
                    <button class="segmented-button__item active ripple" data-view="today">
                        <span class="material-symbols-rounded">today</span>
                        今日
                    </button>
                    <button class="segmented-button__item ripple" data-view="date-select">
                        <span class="material-symbols-rounded">calendar_month</span>
                        選擇日期
                    </button>
                </div>

                <!-- Navigation Buttons (Desktop) -->
                <div class="nav-buttons">
                    <button class="btn btn--tonal ripple" id="prev-day-btn">
                        <span class="material-symbols-rounded">chevron_left</span>
                        上一天
                    </button>
                    <button class="btn btn--tonal ripple" id="next-day-btn">
                        下一天
                        <span class="material-symbols-rounded">chevron_right</span>
                    </button>
                </div>

                <!-- Theme Toggle -->
                <button class="icon-button ripple" id="theme-toggle" aria-label="切換主題">
                    <span class="material-symbols-rounded" id="theme-icon">dark_mode</span>
                </button>

                <!-- Notification Toggle -->
                <button class="icon-button ripple" id="notification-toggle" aria-label="通知設定">
                    <span class="material-symbols-rounded" id="notification-icon">notifications_off</span>
                </button>

                <!-- DateTime (Desktop) -->
                <div class="top-app-bar__datetime">
                    <div class="top-app-bar__date" id="current-date">載入中...</div>
                    <div class="top-app-bar__time" id="current-time">--:--:--</div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left Panel -->
            <aside class="left-panel">
                <!-- Current Status Card -->
                <div class="card card--elevated current-status-card">
                    <div class="card__header">
                        <div class="card__icon">
                            <span class="material-symbols-rounded">schedule</span>
                        </div>
                        <h2 class="card__title">當前狀態</h2>
                    </div>
                    <div class="card__content">
                        <div class="current-status__period" id="current-period-name">載入中...</div>
                        <div class="current-status__time" id="current-period-time">--:-- - --:--</div>
                        <div class="current-status__subject" id="current-subject">正在載入...</div>
                    </div>
                </div>

                <!-- Countdown Card -->
                <div class="card card--elevated countdown-card">
                    <div class="card__header">
                        <div class="card__icon">
                            <span class="material-symbols-rounded">timer</span>
                        </div>
                        <h2 class="card__title">倒計時</h2>
                    </div>
                    <div class="card__content">
                        <div class="countdown__display" id="countdown-display">--:--:--</div>
                        <div class="countdown__label" id="countdown-label">載入中...</div>
                    </div>
                </div>

                <!-- Next Period Card -->
                <div class="card card--elevated next-period-card">
                    <div class="card__header">
                        <div class="card__icon">
                            <span class="material-symbols-rounded">upcoming</span>
                        </div>
                        <h2 class="card__title">下一堂課</h2>
                    </div>
                    <div class="card__content">
                        <div class="next-period__name" id="next-period-name">載入中...</div>
                        <div class="next-period__time" id="next-period-time">--:-- - --:--</div>
                        <div class="next-period__subject" id="next-subject">載入中...</div>
                    </div>
                </div>

                <!-- Date Selection Card -->
                <div class="card card--elevated date-selection" id="date-selection">
                    <div class="card__header">
                        <div class="card__icon">
                            <span class="material-symbols-rounded">calendar_today</span>
                        </div>
                        <h2 class="card__title">選擇日期</h2>
                    </div>
                    <div class="date-controls">
                        <input type="date" id="date-picker" class="date-picker">
                        <button id="view-selected-date" class="btn btn--filled ripple">
                            <span class="material-symbols-rounded">visibility</span>
                            查看
                        </button>
                        <button id="back-to-today" class="btn btn--outlined ripple">
                            <span class="material-symbols-rounded">today</span>
                            返回今日
                        </button>
                    </div>
                    <div class="selected-date-info" id="selected-date-info" style="display: none;">
                        <div class="selected-date-display" id="selected-date-display"></div>
                        <div class="date-details">
                            <span class="chip chip--filled" id="selected-day-cycle"></span>
                            <span class="chip" id="selected-timetable-type"></span>
                        </div>
                    </div>
                </div>

                <!-- Notice Banner -->
                <div class="notice-banner" id="special-notice-banner">
                    <span class="material-symbols-rounded">info</span>
                    <span id="special-notice">載入中...</span>
                </div>
            </aside>

            <!-- Schedule Section -->
            <section class="card card--elevated schedule-section">
                <div class="schedule-header">
                    <h2 class="schedule-title" id="schedule-title">今日時間表</h2>
                    <div class="day-indicator" id="day-indicator">載入中...</div>
                </div>
                <div class="schedule-grid" id="schedule-grid">
                    <!-- Dynamic content -->
                </div>
            </section>
        </main>
    </div>

    <!-- Bottom Navigation (Mobile) -->
    <nav class="bottom-nav" id="bottom-nav">
        <button class="bottom-nav__item active" data-view="today">
            <div class="bottom-nav__icon-container">
                <span class="material-symbols-rounded">today</span>
            </div>
            <span class="bottom-nav__label">今日</span>
        </button>
        <button class="bottom-nav__item" data-view="date-select">
            <div class="bottom-nav__icon-container">
                <span class="material-symbols-rounded">calendar_month</span>
            </div>
            <span class="bottom-nav__label">日曆</span>
        </button>
        <button class="bottom-nav__item" id="nav-prev">
            <div class="bottom-nav__icon-container">
                <span class="material-symbols-rounded">chevron_left</span>
            </div>
            <span class="bottom-nav__label">上一天</span>
        </button>
        <button class="bottom-nav__item" id="nav-next">
            <div class="bottom-nav__icon-container">
                <span class="material-symbols-rounded">chevron_right</span>
            </div>
            <span class="bottom-nav__label">下一天</span>
        </button>
    </nav>

    <!-- Floating Action Button (Mobile) -->
    <button class="fab" id="fab-notifications" aria-label="通知設定">
        <span class="material-symbols-rounded">notifications</span>
    </button>

    <!-- Swipe Indicators -->
    <div class="swipe-indicator left" id="swipe-left">
        <span class="material-symbols-rounded">chevron_left</span>
    </div>
    <div class="swipe-indicator right" id="swipe-right">
        <span class="material-symbols-rounded">chevron_right</span>
    </div>

    <!-- Snackbar -->
    <div class="snackbar" id="snackbar">
        <span id="snackbar-message"></span>
        <button class="snackbar__action" id="snackbar-action">關閉</button>
    </div>

    <!-- Scripts -->
    <script src="timetable-data.js"></script>
    <script src="api.js"></script>
    <script src="notifications.js"></script>
    <script src="script.js"></script>
</body>
</html>
